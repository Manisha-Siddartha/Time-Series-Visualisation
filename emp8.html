<!DOCTYPE html>
<meta charset="utf-8">
<style> /* set the CSS */

 body { font: 12px Arial;}

/*path { 
//    stroke: #474747;
   // stroke-width: 2;
    fill: none;
}*/



.axis path,
.axis line {
    fill: none;
    stroke: grey;
    stroke-width: 1;
    shape-rendering: crispEdges;
}

input[type=text], select {
    width: 20%;
    padding: 5px 8px;
    margin: 4px 0;
    display: inline-block;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
}
<!--layout -->

.checklist{
height=200px;
border:1px solid black;
}
.part1{
  //border:1px solid black;
  float: left;
  width:130px;
  
}
.part2{
  //border:1px solid black;
  float: right;
  width:120px;
  
}
.part3{
  //border:1px solid black;
  float: right;
  width:120px;
  
}
div.container {
    width: 100%;
    border: 1px solid gray;
}


nav {
    float: left;
    max-width: 600px;
    margin: 0;
    padding: 1em;
  height:450px;
  //border:1px solid black;
}

/*.extracredits{
  float : left;
  //border:1px solid black;
  margin-top:20px;
  margin-bottom:20px;
  }*/
  .map{
    float : left;
  //border:1px solid black;
  margin-top:20px;
  margin-bottom:20px;
  }
.background {
  fill: none;
  pointer-events: all;
}

#states {
  fill: #aaa;
}

/*#states .active {
  fill: orange;
}*/

#state-borders {
  fill: none;
  stroke: #fff;
  stroke-width: 1.5px;
  stroke-linejoin: round;
  stroke-linecap: round;
  pointer-events: none;
}
.states-choropleth {
  fill: #ccc;
}
#tooltip-container {
  position: absolute;
  background-color: #fff;
  color: #000;
  padding: 10px;
  border: 1px solid;
  display: none;
}
.tooltip_key {
  font-weight: bold;
}

.tooltip_value {
  margin-left: 20px;
  float: right;
}
.brush .extent {
  stroke: #fff;
  fill-opacity: .125;
  shape-rendering: crispEdges;
}
.button {
    background-color: #4CAF50;
    border: none;
    color: white;
    padding: 5px 32px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
    margin: 4px 2px;
    cursor: pointer;
}

</style>
</style>
<body>


<header>
<h1>
<center>Time Series Visualization</h1></center>
</header>
<!-- load the d3.js library -->  
 
<!-- div class='checklist'>
<h1>Select State</h1>
<form action= >
<div class='part1' >
<input type='checkbox' name='state' value='Alabama'>Alabama<br>
<input type='checkbox' name='state' value='Alaska'>Alaska<br>
<input type='checkbox' name='state' value='Arizona'>Arizona<br>
<input type='checkbox' name='state' value='Arkansas'>Arkansas<br>
<input type='checkbox' name='state' value='California'>California<br>
<input type='checkbox' name='state' value='Colorado'>Colorado<br>
<input type='checkbox' name='state' value='Connecticut'>Connecticut<br>
<input type='checkbox' name='state' value='Delaware'>Delaware<br>
<input type='checkbox' name='state' value='District of Columbia'>District of Columbia<br>

<input type='checkbox' name='state' value='Florida'>Florida<br>
<input type='checkbox' name='state' value='Georgia'>Georgia<br>
<input type='checkbox' name='state' value='Hawaii'>Hawaii<br>
<input type='checkbox' name='state' value='Idaho'>Idaho<br>
<input type='checkbox' name='state' value='Illinois'>Illinois<br>
<input type='checkbox' name='state' value='Indiana'>Indiana<br>
<input type='checkbox' name='state' value='Iowa'>Iowa<br>
<input type='checkbox' name='state' value='Kansas'>Kansas<br>
</div>
<div class='part2' >
<input type='checkbox' name='state' value='Kentucky'>Kentucky<br>

<input type='checkbox' name='state' value='Louisiana'>Louisiana<br>
<input type='checkbox' name='state' value='Maine'>Maine<br>
<input type='checkbox' name='state' value='Maryland'>Maryland<br>
<input type='checkbox' name='state' value='Massachusetts'>Massachusetts<br>
<input type='checkbox' name='state' value='Michigan'>Michigan<br>
<input type='checkbox' name='state' value='Minnesota'>Minnesota<br>
<input type='checkbox' name='state' value='Mississippi'>Mississippi<br>

<input type='checkbox' name='state' value='Missouri'>Missouri<br>
<input type='checkbox' name='state' value='Montana'>Montana<br>

<input type='checkbox' name='state' value='Nebraska'>Nebraska<br>
<input type='checkbox' name='state' value='Nevada'>Nevada<br>
<input type='checkbox' name='state' value='New Hampshire'>New Hampshire<br>
<input type='checkbox' name='state' value='New Jersey'>New Jersey<br>
<input type='checkbox' name='state' value='New Mexico'>New Mexico<br>
<input type='checkbox' name='state' value='New York'>New York<br>
<input type='checkbox' name='state' value='North Carolina'>North
 Carolina<br>
 </div>
 <div class='part3' >
<input type='checkbox' name='state' value='North Dakota'>North Dakota<br>
<input type='checkbox' name='state' value='Ohio'>Ohio<br>

<input type='checkbox' name='state' value='Oklahoma'>Oklahoma<br>
<input type='checkbox' name='state' value='Oregon'>Oregon<br>
<input type='checkbox' name='state' value='Pennsylvania'>Pennsylvania<br>
<input type='checkbox' name='state' value='Rhode Island'>Rhode Island<br>
<input type='checkbox' name='state' value='South Carolina'>South Carolina<br>
<input type='checkbox' name='state' value='South Dakota'>South Dakota<br>
<input type='checkbox' name='state' value='Tennessee'>Tennessee<br>
<input type='checkbox' name='state' value='Texas'>Texas<br>
<input type='checkbox' name='state' value='Utah'>Utah<br>

<input type='checkbox' name='state' value='Vermont'>Vermont<br>
<input type='checkbox' name='state' value='Virginia'>Virginia<br>
<input type='checkbox' name='state' value='Washington'>Washington<br>
<input type='checkbox' name='state' value='West Virginia'>West Virginia<br>
<input type='checkbox' name='state' value='Wisconsin'>Wisconsin<br>
<input type='checkbox' name='state' value='Wyoming'>Wyoming<br>
</div>
<button onclick= myFunction() name= "submit">
<form>
</div> -->
  
<div >
Rise<input type="text" name="pump" id="pump">
<button class='button' onclick= "pump();">pump</button></br>

Drop<input type="text" name="drop" id="drop" >
<button class='button' onclick="drop();">drop</button></br>

<input type="checkbox" name="checking" class="checking" value="National" id="58" > All States<br> 
<input type="checkbox" name="checking" class="checking" value="National" id="57" > National Unemployment rate<br>

</div>




<div id="tooltip-container"></div>

<script src="https://d3js.org/d3.v3.min.js"></script>
<script src="https://d3js.org/topojson.v1.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

<script>

var width1 = 400,
    height1 = 300,
  active = d3.select(null),
  centered;

var projection = d3.geo.albersUsa()
    .scale(400)
    .translate([width1 / 2, height1 / 2]);

var path1 = d3.geo.path()
    .projection(projection);

var svg1 = d3.select("body").append("svg")
    .attr("width", width1)
    .attr("height", height1)
  .on("click", stopped, false);
  
  var states=["Alabama","Alaska","","Arizona","Arkansas","California","","Colorado","Connecticut","Delaware","","Florida","Georgia","","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts"
,"Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma"
,"Oregon","Pennsylvania","","","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia",,"Washington","West Virginia","Wisconsin","Wyoming"];

var color = d3.scale.ordinal().range(["#FF5349","#FDBCB4","#EA7E5D","#FF7538","#FF8243","#CD9575","#DEAA88","#FFBD88","#EFDBC5","#8A795D","#FCD975","#F0E891","#FDFC74","#C5E384","#A8E4A0","#71BC78","#1CAC78","#3BB08F","#158078","#77DDE7","#199EBD","#9ACEEB","#2B6CC4","#B0B7C6","#979AAA","#7442C8","#926EAE","#C364C5","#8E4585","#FF48D0","#6E5160","#F664AF","#F75394","#FDD7E4","#FC89AC","#EE204D","#FC6C85","#CB4154","#CDC5C2",,"#FDBCB4","#EA7E5D","#FF7538","#FF8243","#CD9575","#DEAA88","#FFBD88","#EFDBC5","#8A795D","#FCD975","#F0E891","#FDFC74","#C5E384","#A8E4A0","#71BC78","#1CAC78","#3BB08F","#158078","#77DDE7","#199EBD","#9ACEEB","#2B6CC4","#B0B7C6","#979AAA","#7442C8","#926EAE","#C364C5","#8E4585","#FF48D0","#6E5160","#3BB08F","#158078","#3BB08F","#158078","#3BB08F","#158078","#3BB08F","#158078","#3BB08F","#158078"]);

svg1.append("rect")
    .attr("class", "background")
  .attr("float","left")
    .attr("width", width1)
    .attr("height", height1)
    .on("click", clicked);

var mapg = svg1.append("g");
d3.tsv("https://s3-us-west-2.amazonaws.com/vida-public/geo/us-state-names.tsv", function(error, names) {
  
  name_id_map = {};
  id_name_map = {};
  
  for (var i = 0; i < names.length; i++) {
    name_id_map[names[i].name] = names[i].id;
    id_name_map[names[i].id] = names[i].name;
  }
  
  
  });
d3.json("usstates.json", function(error, us) {
  if (error) throw error;
 var valueById = d3.map();
  mapg.append("g")
  .attr("class", "states-choropleth")
      .attr("id", "states")
    .selectAll("path")
      .data(topojson.feature(us, us.objects.states).features)
    .enter().append("path")
      .attr("d", path1)
      .attr('id',function(d){return 'i'+d.id;})
    .attr("test",function(d){
    console.log(d);
   // debugger;
    })
      .on("click", clicked)
    .on("mousemove", function(d) {
            var html = "";
  
            html += "<div class=\"tooltip_kv\">";
            html += "<span class=\"tooltip_key\">";
            html += id_name_map[d.id];
       
            html += "</span>";
            html += "<span class=\"tooltip_value\">";
            html += (valueById.get(d.id) ? valueFormat(valueById.get(d.id)) : "");html += "";
            html += "</span>";
            html += "</div>";
              
            $("#tooltip-container").html(html);
            $(this).attr("fill-opacity", "0.8");
            $("#tooltip-container").show();
            
            var coordinates = d3.mouse(this);
            
            var map_width = $('.states-choropleth')[0].getBoundingClientRect().width1;
            
            if (d3.event.layerX < map_width / 2) {
              d3.select("#tooltip-container")
                .style("top", (d3.event.layerY + 15) + "px")
                .style("left", (d3.event.layerX + 15) + "px");
            } else {
              var tooltip_width = $("#tooltip-container").width();
              d3.select("#tooltip-container")
                .style("top", (d3.event.layerY + 15) + "px")
                .style("left", (d3.event.layerX - tooltip_width - 30) + "px");
            }
        })
        .on("mouseout", function() {
                $(this).attr("fill-opacity", "1.0");
                $("#tooltip-container").hide();
            })
      .on("click", clicked)
      d3.selectAll(".checking").on("change",national);
    

  mapg.append("path")
      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
      .attr("id", "state-borders")
      .attr("d", path1);
    
});



function clicked(d) {
 /* var x, y, k;

  if (d && centered !== d) {
    var centroid = path1.centroid(d);
    x = centroid[0];
    y = centroid[1];
    k = 4;
    centered = d;
  } else {
    x = width1 / 2;
    y = height1 / 2;
    k = 1;
    centered = null;
  }

  mapg.selectAll("path")
      .classed("active", centered && function(d) { return d === centered; });

  mapg.transition()
      .duration(750)
      .attr("transform", "translate(" + width1 / 2 + "," + height1 / 2 + ")scale(" + k + ")translate(" + -x + "," + -y + ")")
      .style("stroke-width", 1.5 / k + "px");*/
    
    if (active.node() === this) return revert(d);
  active.classed("active", false);
  active = d3.select(this).classed("active", true);
  var bounds = path1.bounds(d),
      dx = bounds[1][0] - bounds[0][0],
      dy = bounds[1][1] - bounds[0][1],
      xx = (bounds[0][0] + bounds[1][0]) / 2,
      yy = (bounds[0][1] + bounds[1][1]) / 2,
      scale = Math.max(1, Math.min(8, 0.9 / Math.max(dx / width, dy / height))),
      translate = [width / 2 - scale * xx, height / 2 - scale * y];
     document.getElementById("i"+d.id).style.fill = color(d.id-1);
  change(d);
  debugger;
}

function revert(d) {
revertmap(d);
document.getElementById("i"+d.id).style.fill = null;
  active.classed("active", false);
  active = d3.select(null);
 }
 
 function stopped() {
  if (d3.event.defaultPrevented) d3.event.stopPropagation();
}

</script>


<!-- unemp -->
<script>
// Set the dimensions of the canvas / graph
var margin = {top: 10, right: 0, bottom:100, left:30},
margin2 = { top: 430, right: 10, bottom: 30, left: 40 },
    width =  800-margin.top,
    height = 500 -margin.top-margin.bottom
    height2 = 500 - margin2.top - margin2.bottom;;

// Parse the date / time
var parseDate = d3.time.format("%d-%b-%y").parse;
var parseDate2 = d3.time.format("%B-%Y").parse;
//var bisectDate = d3.bisector(function(d) { return d.date; }).left;
// Set the ranges
var x = d3.time.scale().range([0, width]);
var x2 = d3.time.scale().range([0, width]);
var y = d3.scale.linear().range([height, 0]);
y2 = d3.scale.linear().range([height2, 0]);

// Define the axes
var xAxis = d3.svg.axis().scale(x).orient("bottom").ticks(15);
var xAxis2 = d3.svg.axis().scale(x2).orient("bottom").ticks(10);
var yAxis = d3.svg.axis().scale(y).orient("left").ticks(20);

var brush = d3.svg.brush().x(x2).on("brush", brush);

// Define the line
var valueline = d3.svg.line()
    .x(function(d) { return x(d.date); })
    .y(function(d) { return y(d.unemplyment); });
  
  var valueline1 = d3.svg.line()
  .x(function(d) { return x(d.date); })
    .y(function(d) { return y(d.unemplyment); });


    
// Adds the svg canvas
var svg = d3.select("body")
    .append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom);
 svg.append("defs")

  .append("rect")
    .attr("id", "clip")
    .attr("width", width)
    .attr("height", height);

var plot1 = svg.append("g")
  .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
      
var plot2 = svg.append("g")
  .attr("transform", "translate(" + margin2.left + "," + margin2.top + ")");
 

 var dataAll = {};
 
 d3.csv("Nationalrate.csv",function(error,data){
    data.forEach(function(d){
      if(dataAll[d.State]==undefined)
        dataAll[d.State]=[];
      dataAll[d.State].push(d);
    });
    })
d3.csv("unemplyment.csv", function(error, data) {    
  dataTX = [];
 // dataTX1 = [];  // Only time series for TX
 // var state= [];
  data.forEach(function(d) {
    if(dataAll[d.State]== undefined)
    dataAll[d.State]=[];
    dataAll[d.State].push(d);
   // state= d.State;
    });
  for(var statename in dataAll){
  dataAll[statename].forEach(function(d) {
    d.date = parseDate2(d.Month+"-"+d.Year);
    d.unemplyment = +d["Unemployment rates by State, not seasonally adjusted"];
    //    dataTX.push(d);
  });
  
   dataAll[statename].sort(function(a,b){
    if (a.date<b.date)
        return -1;
    else if (a.date>b.date)
        return 1;
    else
        return 0;
  })  
  }

    // Scale the range of the data
    x.domain(d3.extent(dataAll["Illinois"], function(d) { return d.date; }));
    y.domain([0,20]);
     x2.domain(x.domain());
    y2.domain(y.domain());

var dataArray = [];
for(var statename in dataAll){
  if(statename=="National rate" ||statename=="Rhode Island"||statename=="District of Columbia")
    continue;
  dataArray.push(dataAll[statename]);
}

    dataArray.push(dataAll["National rate"]);
var duplicate=[];
    var j=0;
    
        
    for(var i=1;i<58;i++){
    if(i==3||i==7||i==11||i==14||i==43||i==44||i==52){
    continue;
    }
    // Add the valueline path.
    duplicate.push(dataArray[j]);
    j++;

    plot1.selectAll(".line")
      .data(duplicate).enter()
       .append("g")
        .append("path")
    
        .attr("class", "line")
    .attr("id","idno"+i)
    .attr("fill","none")
    .style("display","none")
    .attr("stroke","#474747")
    .attr("stroke-width",2)
    .attr("stroke",function(d){
      return color(d[0].State);
      })
        .attr("d", function(d){ 
     return valueline(d);
    })
    .style("stroke", function(d) {return color(i-1);})
    .attr("clip-path", "url(#clip)");
  }


      plot1.selectAll(".line1")
  .data(dataArray)
  .enter()
      .append("path")
     
    .attr("fill","none")
    .attr("stroke","#474747")
        .attr("class", "line1")
    .attr("stroke-opacity",0)
    .attr("stroke-width",5)
    .attr("stroke",function(d){
      return color(i-1);
      })
        .attr("d", function(d){ 
     return valueline(d) 
    })
    .on("mouseover", function(d1)
    {
      plot1.selectAll(".line")
      .transition().duration(300)
      .attr("stroke-opacity",function(d2){
        if(d1==d2)
        return 1;
        else
        return 0.1;
      });
      })
    .on("mouseout",function(d){
      svg.selectAll(".line")
      .transition().duration(300)
      .attr("stroke-opacity",1);
      })
      
    /*plot1.selectAll(".line")
  .append("title")
  .text( function(d){ return d[0].State+" "+d[0].Year;});*/
  
  svg.selectAll(".line1").append("title")
  .text(function(d) {
  return d[0].State+" "+d[0].Year+" "+d[0].unemplyment;
  });
  

    plot1.append("g")
        .attr("class", "x axis")
        .attr("transform", "translate(0," + height + ")")
        .call(xAxis);
 
    plot1.append("g")
        .attr("class", "y axis")
        .call(yAxis);

        duplicate=[];
    j=0;
    for(var i=1;i<57;i++){
    if(i==3||i==7||i==11||i==14||i==43||i==44||i==52){
    continue;
    }
      
    duplicate.push(dataArray[j]);
    j++;

    plot2.selectAll(".line")
      .data(duplicate).enter()
      .append("path")
   
      .append("g")
        .attr("class", "line")
    .attr("id","idno"+i)
    .attr("fill","none")
    .style("display","none")
    .attr("stroke","#474747")
    .attr("stroke-width",2)
    .attr("stroke",function(d){
      return color(d[0].State);
      })
        .attr("d", function(d){ 
     return valueline1(d);
    })
    .style("stroke", function(d) {return color(d[0].State);})
    .attr("clip-path", "url(#clip)");
    }
   plot2.append("g")
        .attr("class", "x axis")
        .attr("transform", "translate(0," + height2 + ")")
        .call(xAxis2);
 
    plot2.append("g")
        .attr("class", "x brush")
        .call(brush)
      .selectAll("rect")
        .attr("y", -6)
        .attr("height", height2 + 7);
        
});



function change(d){         
            console.log(d.id);
           // debugger;
            document.getElementById("idno"+d.id).style.display = "";
        }
  function revertmap(d){         
            console.log(d.id);
            document.getElementById("idno"+d.id).style.display = "none";
        }

<!-- pump -->
function pump()
{ 
var pump_amount= document.getElementById("pump").value;
  plot1.selectAll(".line")
  .attr("stroke-opacity", function(unrate){
    var elevation = false;
    for(var i=1;i<unrate.length;i++ ){
    if((unrate[i].unemplyment-unrate[i-1].unemplyment)>pump_amount)
    elevation = true;
  debugger;
    }
    if (elevation)
    return 1;
    else
    return 0.1;
}); 
}
//x2.domain(x.domain());
 //   y2.domain(y.domain());

svg.selectAll(".y axis text")  // select all the text elements for the xaxis
          .attr("transform", function(d) {
             
             return "translate(" + this.getBBox().height*-6 + "," + this.getBBox().height + ")";
         });

//------appending the text-------
svg.append("text")
            .attr("text-anchor", "margin-right")  // this makes it easy to centre the text as the transform is applied to the anchor
            .attr("transform", "rotate(-90)")
            .attr("y", 45)
            .attr("x", -180)
      .attr("dy", "0.71em")
      .attr("fill", "#000")
              // text is drawn off the screen top left, move down and out and rotate
            .text("Unemployment Rate(%)");


<!-- drop-->
function drop()
{ 
var drop_amount= document.getElementById("drop").value;
drop_amount= Number(drop_amount);
  plot1.selectAll(".line")
  .attr("stroke-opacity", function(unrate){
    var depression = false;
    for(var i=1;i<unrate.length;i++ ){
    if((unrate[i-1].unemplyment-unrate[i].unemplyment)>drop_amount)
    depression = true;
    }
    if (depression)
    return 1;
    else
    return 0.1; 
});

}
function brush() {
  x.domain(brush.empty() ? x2.domain() : brush.extent());
  plot1.selectAll("path.line").attr("d",  function(d) {return valueline(d)});
  plot1.select(".x.axis").call(xAxis);
  plot1.select(".y.axis").call(yAxis);
}
function manisha(element){
  if(element.checked)
window.alert("checked");
  
}
function national(d){
  if(this.id==57){
  if (!document.getElementById(this.id).checked) {
          
            document.getElementById("idno"+this.id).style.display = "none";
  } else {
            
            document.getElementById("idno"+this.id).style.display = "";
  }
  }
  else{
    if (!document.getElementById(this.id).checked) {
      for(var i=1;i<58;i++){
        if(i==3||i==7||i==11||i==14||i==43||i==44||i==52){
          continue;
        }
          document.getElementById("i"+i).style.fill = "#fff";
          document.getElementById("idno"+i).style.display = "none";
          
      }
    }
    else{
      for(var i=1;i<58;i++){
        if(i==3||i==7||i==11||i==14||i==43||i==44||i==52){
          continue;
        }
          document.getElementById("i"+i).style.fill = color[i-1];
          document.getElementById("idno"+i).style.display = "";
          
      }
    }
  }
} 

</script> 

</body>
